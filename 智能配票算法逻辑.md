• 问题描述
这是一个多目标组合优化问题，类似于带多维偏好的0/1背包问题（不允许拆分时）或部分背包问题（允许拆分时），目标是在票据池中选出不超过最大张数限制的票据子集（组合），使组合的总金额尽可能接近付款单金额M（接近的含义是可大于M也可小于M，大于M时做拆票，小于M时候可拆票可组合电汇补齐尾差），同时满足配票偏好、目标权重配置、拆票规则和约束条件。
• 输入：
    ◦ 单付款单
        ▪ 付款单金额M(单位：元)。
        ▪ 付款单所属组织：pay_organization
    ◦ 票据池：N张票据（7000～10000张），
        每张票据i有属性：
        ▪ 票面金额A_i（假设为正实数，单位：元）。
        ▪ 票面金额分类A_C_i（按照客户划定的区间可分为大票、中票、小票三种类型）。
        ▪ 到期期限D_i（距离当前日期的天数，正整数）。
        ▪ 承兑人分类C_i（假设为数值评分，范围[1,8]，数值越小越好；或分类标签，如"优质"、"一般"、"差"，可映射为数值）。
        ▪ 票据所属组织：ticket_organization。
        票据池N有以下属性（仅当allow_inventory_balance参数为True时，才会传入以下属性，否则不考虑）：
        ▪ 票据池N中各个类型票据占比分别为：p_c_big、p_c_middle、p_c_small，其中p_c_big+p_c_middle+p_c_small=1
        ▪ 票据池N中各个类型票据张数分别为：n_c_big、n_c_middle、n_c_small；
◦ 用户配票偏好参数：
    ▪ prefer_exact: 是否优先匹配等额票（布尔值，true/false），当有多张候选等额票时，需要按照目标权重配置中的票据排序择优选取一个。
    ▪ allow_inventory_balance: 是否需要考虑库存平衡分布，用来优化客户期望库存票据类型占比（布尔值，true/false）；
    ▪ amount_dist: 票据金额区间划分（用户自定义，比较个性化），有两种类型，{'大额'：[min,max],'小额'：[min,max]}
    ▪ remain_dist: 用户期望配票结束后剩余票据张数区间布，例如{"大额": e_p_c_big, "中额": e_p_c_middle "小额": e_p_c_small}。
    ▪ allow_split: 是否允许拆分票据（布尔值）；
◦ 目标权重配置：
    ▪ w1, w2, w3，w4（权重，和为1）。
    ▪ amount_strategy（权重w1）: 金额策略，总共有6种类型，分别是大额优先、小额优先、金额随机、接近但小于交易单金额（当票据不可拆分时，尾差需要用电汇补齐）、接近但大于交易单金额（拆票）、优化期望库存票据占比。
        • 如果金额策略=优化期望库存票据占比，则根据票据类型的库存分布和用户期望库存分布，计算得到票据类型偏好。比如用户期望票据分布为：{大额": 0.5, "中额": 0.4 "小额": 0.1},实际初始库存分布为{大额": 0.3, "中额": 0.5 "小额": 0.2}，则大额、中额、小额票据的优先消耗顺序和权重为：中票（权重：5/6）>小票（权重：1/6）>大票（权重：0）；
        • 如果金额策略=大额优先，子策略有两种可选，分别是：大额内随机/大额内从大到小排序进行选票。
        • 如果金额策略=小额优先，子策略有两种可选，分别是：小额内随机/小额内从小到大排序进行选票。
        • 如果金额策略=金额随机，则随机选择票据；
        • 如果金额策略=接近但小于交易单金额时，择强制走电汇尾差，不做拆票。
        • 如果金额策略=接近但大于交易单金额，则强制拆票，不走电汇尾差。
    ▪ term_strategy（权重w2）: 期限策略（"优先远-天数阈值T_far"、"优先近-天数阈值T_near"）。
    ▪ acceptor_strategy（权重w3）: 承兑人策略（"优先差-分类数值由大到小排序、"优先好-分类数值由小到大排序"）。
    ▪ orgization_strategy（权重w4）:跨组织用票策略，子策略有两种，分别是：1.优先使用当前付款单所属组织的票；2.优先使用其他组织的票。如果优先使用当前付款单所属组织的票，则优先匹配票据所属组织=付款单所属组织的票，如果优先优先使用其他组织的票，则优先匹配票据所属组织不等于付款单所属组织的票
◦ 拆票规则：
    ▪ 拆分类型：有三种类型，设置尾差范围（尾差占付款单金额占比）/无限制/尾差金额
    ▪ bias_amount：差额 = 付款单金额-当前票据总金额
    ▪ tail_diff: 尾差阈值
    ▪ 具体拆分规则： 如果bias_amount（差额 ）大于0且bias_amount(差额) < tail_diff，则可选择不拆票，使用电汇尾差，否则从票据池中选择一张新票进行拆分; 如果bias_amount小于0，则从当前票据组合中选择一张票据进行拆分；拆票的策略遵循以下拆票策略。
    ▪ split_strategy：拆票策略，有三种。可直接复用权重配置中的这三个维度，票据到期期限/票据承兑人分类/票据金额（又可以分为大额优先/接近大于差额两种子策略）；
◦ 拆票约束：
    ▪ remain_after_split: 票据拆分后留存金额阈值（留存 >= remain_after_split，与尾差区别：尾差针对总差额，留存针对单张票据拆分后留存部分）。如果留存金额小于remain_after_split，则尝试对其他票据进行拆分，尝试N此后还不能满足条件则会退到上一个拆票策略。
    ▪ max_tickets: 单张交易单最多可用票据张数S_max。
    ▪ max_amount: 最大可用票据金额（单张付款单）。
    ▪ min_amount: 最小可用票据金额（单张付款单，包括拆分后）。
    ▪ max_mini_amount_tickets:不允许使用多张极小金额票据
    ▪ 票据金额非负，单位元，保留小数点后两位。
◦ 输出：
    ▪ 选中的票据组合：列表[(票据ID, 使用金额)]。
    ▪ 选票结构分布：（大、中、小票的数量及占比）；
    ▪ 选票组合得分；
    ▪ 选票耗时：
    ▪ 总组合金额sum_y。
    ▪ 电汇尾差（如有） = M - sum_y。
    ▪ 拆票金额（如有）= M - sum_y或者sum_y-M；
    ▪ 留存金额（如有）
    ▪ 余票库存分布（检查是否满足remain_dist））
基于上面的内容，请给出你的建模过程，包括但不限于变量设计、约束设计、目标函数设计等关键信息，并输出可落地的项目代码。要求，要兼顾效率和效果。

